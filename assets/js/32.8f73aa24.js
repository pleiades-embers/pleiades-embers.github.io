(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{238:function(_,v,t){"use strict";t.r(v);var e=t(0),a=Object(e.a)({},function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h2",{attrs:{id:"_4数据库优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4数据库优化","aria-hidden":"true"}},[_._v("#")]),_._v(" 4数据库优化")]),_._v(" "),t("h3",{attrs:{id:"什么对数据库的性能造成了影响"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么对数据库的性能造成了影响","aria-hidden":"true"}},[_._v("#")]),_._v(" 什么对数据库的性能造成了影响")]),_._v(" "),t("p",[_._v("1.数据库存储引擎的选择")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("MyISAM : 不支持事务，表级锁")])]),_._v(" "),t("li",[t("p",[_._v("InnoDB:事务级存储引擎，完美支持行级锁 ，事务ACID特性")])])]),_._v(" "),t("p",[_._v("数据库表结构设计")]),_._v(" "),t("p",[_._v("sql语句的编写和优化")]),_._v(" "),t("h3",{attrs:{id:"mysql-版本区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-版本区别","aria-hidden":"true"}},[_._v("#")]),_._v(" mysql 版本区别")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191026123516.png",alt:""}})]),_._v(" "),t("h3",{attrs:{id:"使用raid-增加传统机器硬盘的性能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用raid-增加传统机器硬盘的性能","aria-hidden":"true"}},[_._v("#")]),_._v(" 使用RAID 增加传统机器硬盘的性能")]),_._v(" "),t("p",[_._v("RAID 是磁盘冗余队列的简称")]),_._v(" "),t("p",[_._v("（Redundant Arrays of Independent Disks）")]),_._v(" "),t("p",[_._v("RAID的作用就是可以把多个容量较小的磁盘组成一组容量更大额磁盘，并提供数据冗余来保证数据完整性的技术")]),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191010083516.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191010083628.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191010083753.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191010083936.png"}}),_._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191010084120.png",alt:""}})]),_._v(" "),t("h3",{attrs:{id:"centos系统参数优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos系统参数优化","aria-hidden":"true"}},[_._v("#")]),_._v(" centOS系统参数优化")]),_._v(" "),t("h4",{attrs:{id:"内核相关参数（-etc-sysctl-conf）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内核相关参数（-etc-sysctl-conf）","aria-hidden":"true"}},[_._v("#")]),_._v(" 内核相关参数（/etc/sysctl.conf）")]),_._v(" "),t("p",[_._v("net.core,somaxconn=65535     这个参数决定了每个端口最大监听长度")]),_._v(" "),t("p",[_._v("net.core.netdev_max_backlog=65535  在每个网络接收数据包的速率比内核处理速率快的时候允许 接收最大数据包的数目")]),_._v(" "),t("p",[_._v("net.ipv4.tcp_max_syn_backlog")]),_._v(" "),t("p",[_._v("net.ipv4.tpc_fin_timeout=10   Tcp连接处理最大等待时间")]),_._v(" "),t("p",[_._v("net.ipv4.tcp_tw_reuse=1")]),_._v(" "),t("p",[_._v("net.ipv4.tcp_tw_recycle=1")]),_._v(" "),t("p",[_._v("net.core.wmen_default=87380")]),_._v(" "),t("p",[_._v("net.core.wmem_max=16777216")]),_._v(" "),t("p",[_._v("net.core.rmem_default=87380")]),_._v(" "),t("p",[_._v("net.core.rmem_max=16777216")]),_._v(" "),t("p",[_._v("tcp连接接收和发送缓冲区大小默认值")]),_._v(" "),t("p",[_._v("net.ipv4.tcp_keepalive_time=120")]),_._v(" "),t("p",[_._v("net.ipv4.tcp_keepalive_intvl=30")]),_._v(" "),t("p",[_._v("net.ipv4.tcp_keepalive_probes=3")]),_._v(" "),t("p",[_._v("失效连接占用tpc系统资源数量")]),_._v(" "),t("p",[_._v("kernel.shmmax=4294967295")]),_._v(" "),t("p",[_._v("Linux内核参数中最重要的参数之一，用于定义单个共享内存段的最大值")]),_._v(" "),t("p",[_._v("这个参数应该设置的足够大，以便能在一个共享内存段容纳下整个的Innodb缓冲池的大小")]),_._v(" "),t("p",[_._v("这个值的大小对于64位linux系统，可取的最大值为物理内存值 -1byte,建议值为大于物理内存")]),_._v(" "),t("p",[_._v("的一半一般取值大于innodb 缓冲赤的大小即可 物理内存-1byte")]),_._v(" "),t("p",[_._v("vm.swappiness=0")]),_._v(" "),t("p",[_._v("这个参数当内存不足时会对性能产生比较明显的影响")]),_._v(" "),t("p",[_._v("Linux系统安装时都会有一个特殊的磁盘分区，系统交换分区，如果我们使用free-m在系统中查看可以看到类似下面的内容其中swap就是交换分区")]),_._v(" "),t("p",[_._v("当操作系统因为没有足够的内存时就会将一些虚拟内存写道磁盘交换区中 这样就会发生内存交换")]),_._v(" "),t("p",[_._v("=0 就是告诉linux内核除非虚拟内存完全满了，否则不要使用交换区")]),_._v(" "),t("h4",{attrs:{id:"增加资源限制（-etc-security-limit-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#增加资源限制（-etc-security-limit-conf","aria-hidden":"true"}},[_._v("#")]),_._v(" 增加资源限制（/etc/security.limit.conf)")]),_._v(" "),t("p",[_._v("这个文件实际上是linx PAM也就是插入式认证模块的配置文件")]),_._v(" "),t("p",[_._v("打开文件数限制")]),_._v(" "),t("p",[_._v("*soft nofile 65535")]),_._v(" "),t("p",[_._v("*hard nofile 65535")]),_._v(" "),t("p",[_._v("加到limit.conf文件末尾")]),_._v(" "),t("ul",[t("li",[_._v("*表示对所有用户有效")]),_._v(" "),t("li",[_._v("soft 指的是当前系统生效的设置")]),_._v(" "),t("li",[_._v("hard 表明系统中所能设定的最大值")]),_._v(" "),t("li",[_._v("nofile 表示所限制的资源是打开文件的最大数目")]),_._v(" "),t("li",[_._v("65535 就是限制的数量")])]),_._v(" "),t("p",[_._v("文件修改需要重启操作系统才能生效")]),_._v(" "),t("h4",{attrs:{id:"磁盘调度策略（-sys-block-devname-queue-scheduler"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘调度策略（-sys-block-devname-queue-scheduler","aria-hidden":"true"}},[_._v("#")]),_._v(" 磁盘调度策略（/sys/block/devname/queue/scheduler)")]),_._v(" "),t("p",[_._v("cat/sys/block/sda/queue/scheduler noop anticipatory deadline[cfq]")]),_._v(" "),t("p",[_._v("noop (电梯式调度策略）")]),_._v(" "),t("p",[_._v("NOOP实现了一个FIFO队列，塔像电梯的工作方法一样对 I/O请求进行组织，当有一个新的请求到来时，它将请求合并到最近的请求之后，以此来保证请求同一介质。NOOP 倾向饿死读而利于写，因此NOOP对于"),t("code",[_._v("闪存设备")]),_._v("、"),t("code",[_._v("RAM")]),_._v("及"),t("code",[_._v("嵌入式系统")]),_._v("是最好的选择。")]),_._v(" "),t("p",[_._v("deadline(截止时间调度策略）\nDeadline确保了在一个截至时间内服务请求，这个截止时间是可调整的，而默认读期限短于写期限。这样就防止了写操作因为不能被读取而饿死的现象 Deadline 对数据库类应用时最好的选择")]),_._v(" "),t("p",[_._v("anticipatory(预料I/O调度策略)\n本质上与Deadline一样，但在最后一次读操作后，要等待6ms，才能据徐进行其他I/O请求进行调度。它会下每个6ms中插入新的I/O操作，而回将一些小写入流合成一个大写入流，用写入延时换取最大的写入吞吐量。AS适合于写入较多的环境，比如文件服务器，AS对数据库环境表现很差")]),_._v(" "),t("h3",{attrs:{id:""}},[t("a",{staticClass:"header-anchor",attrs:{href:"#","aria-hidden":"true"}},[_._v("#")])]),_._v(" "),t("h4",{attrs:{id:"ext3-4系统的挂在参数-（-etc-fstab）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ext3-4系统的挂在参数-（-etc-fstab）","aria-hidden":"true"}},[_._v("#")]),_._v(" EXT3/4系统的挂在参数 （/etc/fstab）")]),_._v(" "),t("p",[_._v("data=writeback|ordered|journal")]),_._v(" "),t("p",[_._v("writeback 只有原数据写入日志   源数据和数据写入并不是同步的")]),_._v(" "),t("p",[_._v("ordered 只会记录原数据 在写原数据之前会先写日志")]),_._v(" "),t("p",[_._v("journal 在数据写入最终位置之前 会写入日志中")]),_._v(" "),t("p",[_._v("noatime,nodiratime")]),_._v(" "),t("p",[_._v("减少写操作的时间")]),_._v(" "),t("p",[_._v("/def/sda1/ext4 noatime,nodiratime,data=writeback 1 1")]),_._v(" "),t("h3",{attrs:{id:"mysql-常用存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-常用存储引擎","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQL 常用存储引擎")]),_._v(" "),t("h4",{attrs:{id:"myisam"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#myisam","aria-hidden":"true"}},[_._v("#")]),_._v(" MyISAM")]),_._v(" "),t("p",[_._v("MySQL 5.5之前版本默认存储引擎")]),_._v(" "),t("p",[_._v("临时表 在排序，分组的操作后，当数量超过一定大小之后，由查询优化器建立的临时表")]),_._v(" "),t("p",[_._v("myisam存储引擎表由MYd和MYI组成")]),_._v(" "),t("p",[_._v("特性")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("并发性与锁级别")])]),_._v(" "),t("li",[t("p",[_._v("表损坏修复")])])]),_._v(" "),t("p",[_._v("check table tablename")]),_._v(" "),t("p",[_._v("repair table tablename")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("MyISAM 表支持索引类型")])]),_._v(" "),t("li",[t("p",[_._v("MyISAM 表支持数据压缩")]),_._v(" "),t("p",[_._v("命令行：myisampack")]),_._v(" "),t("p",[_._v("myisampack -b -f myISam.MYI")])])]),_._v(" "),t("p",[_._v("限制")]),_._v(" "),t("p",[_._v("​\t版本< MySQL5.0 时默认表大小为4G")]),_._v(" "),t("p",[_._v("​\t如存储大表则要修改MAX_ROWS 和AVG_ROW_LENGTH")]),_._v(" "),t("p",[_._v("​\t版本> MySQL5.0时 默认支持为256TB")]),_._v(" "),t("p",[_._v("适用场景")]),_._v(" "),t("ul",[t("li",[_._v("​\t非事务型应用")]),_._v(" "),t("li",[_._v("只读类应用")]),_._v(" "),t("li",[_._v("空间类应用")])]),_._v(" "),t("h4",{attrs:{id:"innodb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#innodb","aria-hidden":"true"}},[_._v("#")]),_._v(" Innodb")]),_._v(" "),t("p",[_._v("mysql 5.5之后版本默认存储引擎")]),_._v(" "),t("p",[_._v("使用表空间进行 数据存储")]),_._v(" "),t("p",[_._v("innodb_file_per_table")]),_._v(" "),t("p",[_._v("ON：独立表空间：tablename.ibd")]),_._v(" "),t("p",[_._v("OFF:系统表空间 ：ibdataX")]),_._v(" "),t("h5",{attrs:{id:"innodb存储引擎的特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#innodb存储引擎的特性","aria-hidden":"true"}},[_._v("#")]),_._v(" innodb存储引擎的特性")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Innodb是一种事务性存储引擎")])]),_._v(" "),t("li",[t("p",[_._v("完全支持事务的ACID特性")])]),_._v(" "),t("li",[t("p",[_._v("redo Log 和 Undo log")])]),_._v(" "),t("li",[t("p",[_._v("Innodb支持行级锁")])]),_._v(" "),t("li",[t("p",[_._v("行级锁可以最大程度的支持并发")])]),_._v(" "),t("li",[t("p",[_._v("行级锁匙由存储引擎层实现的")]),_._v(" "),t("ul",[t("li",[_._v("锁的主要作用是管理共享资源的并发访问")]),_._v(" "),t("li",[_._v("锁用于实现事务的隔离性")]),_._v(" "),t("li",[_._v("共享锁（读锁）")]),_._v(" "),t("li",[_._v("独占锁（写锁）")])])])]),_._v(" "),t("h5",{attrs:{id:"表转移步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#表转移步骤","aria-hidden":"true"}},[_._v("#")]),_._v(" 表转移步骤")]),_._v(" "),t("ol",[t("li",[_._v("使用mysqldump到处所有数据库表数据")]),_._v(" "),t("li",[_._v("停止mySQL服务，修改参数，并删除Innodb 香港文件")]),_._v(" "),t("li",[_._v("重启 mySQL服务，重建Innodb系统表空间")]),_._v(" "),t("li",[_._v("重新导入数据")])]),_._v(" "),t("h5",{attrs:{id:"系统表空间和独立表空间要如何选择"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统表空间和独立表空间要如何选择","aria-hidden":"true"}},[_._v("#")]),_._v(" 系统表空间和独立表空间要如何选择")]),_._v(" "),t("p",[_._v("innodb 数据字典信息")]),_._v(" "),t("p",[_._v("Undo 回滚段")]),_._v(" "),t("h4",{attrs:{id:"csv"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#csv","aria-hidden":"true"}},[_._v("#")]),_._v(" CSV")]),_._v(" "),t("p",[_._v("文件系统存储特点")]),_._v(" "),t("p",[_._v("​\t数据以文本方式存储在文件中")]),_._v(" "),t("p",[_._v("特点")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("以CSV格式进行数据存储")])]),_._v(" "),t("li",[t("p",[_._v("所有列必须都是不能为NULL的")])]),_._v(" "),t("li",[t("p",[_._v("不支持索引， 不适合大表，不适合在线处理")])]),_._v(" "),t("li",[t("p",[_._v("可以对数据文件直接编辑")]),_._v(" "),t("p",[_._v("保存文件内容")])])]),_._v(" "),t("h4",{attrs:{id:"archive-存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#archive-存储引擎","aria-hidden":"true"}},[_._v("#")]),_._v(" Archive 存储引擎")]),_._v(" "),t("ul",[t("li",[_._v("以zlib对表数据进行压缩，磁盘I/O更少")]),_._v(" "),t("li",[_._v("数据存储在ARZ为后缀的文件中")]),_._v(" "),t("li",[_._v("只支持insert 和select操作")]),_._v(" "),t("li",[_._v("只允许在自增ID列上加索引")])]),_._v(" "),t("h4",{attrs:{id:"memory-存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memory-存储引擎","aria-hidden":"true"}},[_._v("#")]),_._v(" Memory 存储引擎")]),_._v(" "),t("ul",[t("li",[_._v("也称为HEAP存储引擎，所以数据保存在内存中")]),_._v(" "),t("li",[_._v("支持HASH索引和BTree索引")])]),_._v(" "),t("h4",{attrs:{id:"federated存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#federated存储引擎","aria-hidden":"true"}},[_._v("#")]),_._v(" Federated存储引擎")]),_._v(" "),t("p",[_._v("默认禁止,启动需要在启动时怎加federated参数")]),_._v(" "),t("h3",{attrs:{id:"数据库逻辑设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库逻辑设计","aria-hidden":"true"}},[_._v("#")]),_._v(" 数据库逻辑设计")]),_._v(" "),t("h4",{attrs:{id:"宽表模式存在的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#宽表模式存在的问题","aria-hidden":"true"}},[_._v("#")]),_._v(" 宽表模式存在的问题")]),_._v(" "),t("ul",[t("li",[_._v("数据插入异常：部分数据由于确实主键信息 而无法写入表中")]),_._v(" "),t("li",[_._v("数据更新一场：修改一行中某列的值是，同时修改了多行数据")]),_._v(" "),t("li",[_._v("数据删除异常: 删除某一数据时不得不删除另一数据")]),_._v(" "),t("li",[_._v("数据冗余：相同的数据在一个表中出现了多次")])]),_._v(" "),t("h4",{attrs:{id:"数据库设计范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库设计范式","aria-hidden":"true"}},[_._v("#")]),_._v(" 数据库设计范式")]),_._v(" "),t("ul",[t("li",[_._v("第一范式:表中的所有字段都是不可再分的")]),_._v(" "),t("li",[_._v("第二范式：表中必须存在业务主键，并且非主键依赖于全部业务主键")])]),_._v(" "),t("h3",{attrs:{id:"数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据类型","aria-hidden":"true"}},[_._v("#")]),_._v(" 数据类型")]),_._v(" "),t("h4",{attrs:{id:"常用的浮点类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用的浮点类型","aria-hidden":"true"}},[_._v("#")]),_._v(" 常用的浮点类型")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("列类型")]),_._v(" "),t("th",{staticStyle:{"text-align":"left"}},[_._v("存储空间")]),_._v(" "),t("th",[_._v("是否精确类型")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("FLOAT")]),_._v(" "),t("td",{staticStyle:{"text-align":"left"}},[_._v("4个字节")]),_._v(" "),t("td",[_._v("否")])]),_._v(" "),t("tr",[t("td",[_._v("DOUBLE")]),_._v(" "),t("td",{staticStyle:{"text-align":"left"}},[_._v("8个字节")]),_._v(" "),t("td",[_._v("否")])]),_._v(" "),t("tr",[t("td",[_._v("DECIMAL")]),_._v(" "),t("td",{staticStyle:{"text-align":"left"}},[_._v("每4个字节存9个数字，小数点占一个字节")]),_._v(" "),t("td",[_._v("是")])])])]),_._v(" "),t("h4",{attrs:{id:"常用的时间类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用的时间类型","aria-hidden":"true"}},[_._v("#")]),_._v(" 常用的时间类型")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("类型")]),_._v(" "),t("th",[_._v("存储空间")]),_._v(" "),t("th",[_._v("格式")]),_._v(" "),t("th",[_._v("范围")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("DATE")]),_._v(" "),t("td",[_._v("3字节")]),_._v(" "),t("td",[_._v("YYYY-MM-DD")]),_._v(" "),t("td",[_._v("从'1000-01-01'到'9999-12-31'")])]),_._v(" "),t("tr",[t("td",[_._v("TIME")]),_._v(" "),t("td",[_._v("3-6字节")]),_._v(" "),t("td",[_._v("HH:MM:SS[.微秒值]")]),_._v(" "),t("td",[_._v("从‘-838:59:59'到 ’838:59:59'")])]),_._v(" "),t("tr",[t("td",[_._v("YEAR")]),_._v(" "),t("td",[_._v("1字节")]),_._v(" "),t("td",[_._v("YYYY")]),_._v(" "),t("td",[_._v("从1901到2155")])]),_._v(" "),t("tr",[t("td",[_._v("DATETIME")]),_._v(" "),t("td",[_._v("5-8字节")]),_._v(" "),t("td",[_._v("YYYY-MM-DD HH:MM:SS [.微秒值]")]),_._v(" "),t("td",[_._v("从'1000-01-01 00:00:00' 到'9999-12-31 23:59:59'")])]),_._v(" "),t("tr",[t("td",[_._v("TIMESTAMP")]),_._v(" "),t("td",[_._v("4-7字节")]),_._v(" "),t("td",[_._v("YYYY-MM-DD HH:MM:SS [.微秒值]")]),_._v(" "),t("td",[_._v("从 '1970-01-01' 00:00:01' UTC 到‘2038-01-19 03:14:07’   UTC")])])])]),_._v(" "),t("h4",{attrs:{id:"常用字符串类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用字符串类型","aria-hidden":"true"}},[_._v("#")]),_._v(" 常用字符串类型")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("类型")]),_._v(" "),t("th",[_._v("范围")]),_._v(" "),t("th",[_._v("说明")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("Char(M)")]),_._v(" "),t("td",[_._v("M=1~255个字符")]),_._v(" "),t("td",[_._v("固定长度")])]),_._v(" "),t("tr",[t("td",[_._v("VarChar(M)")]),_._v(" "),t("td",[_._v("一行中所有varchar类型的列所占用的字节数不呢个超过65535个字节")]),_._v(" "),t("td",[_._v("存储可变长度的M个字符")])]),_._v(" "),t("tr",[t("td",[_._v("TinyText")]),_._v(" "),t("td",[_._v("最大长度255个字节")]),_._v(" "),t("td",[_._v("可变长度")])]),_._v(" "),t("tr",[t("td",[_._v("Text")]),_._v(" "),t("td",[_._v("最大长度65535个字节")]),_._v(" "),t("td",[_._v("可变长度")])]),_._v(" "),t("tr",[t("td",[_._v("MediumText")]),_._v(" "),t("td",[_._v("最大长度16777215个字节")]),_._v(" "),t("td",[_._v("可变长度")])]),_._v(" "),t("tr",[t("td",[_._v("LongText")]),_._v(" "),t("td",[_._v("最大长度4294967295个字节")]),_._v(" "),t("td",[_._v("可变长度")])]),_._v(" "),t("tr",[t("td",[_._v("Enum")]),_._v(" "),t("td",[_._v("集合最大数目为65535")]),_._v(" "),t("td",[_._v("只能插入列表中的值")])])])]),_._v(" "),t("h4",{attrs:{id:"如何为数据选择合适的数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何为数据选择合适的数据类型","aria-hidden":"true"}},[_._v("#")]),_._v(" 如何为数据选择合适的数据类型")]),_._v(" "),t("ul",[t("li",[_._v("优先选择符合存储数据需求的最小数据类型")]),_._v(" "),t("li",[_._v("使用 INET_ATON('255.255.255.255')=4294967295   将字符串转为整数")]),_._v(" "),t("li",[_._v("INET_NTOA (4394967295)  ='255.255.255.255'  将int 转化为字符串")]),_._v(" "),t("li",[_._v("谨慎使用ENUM,TEXT 字符串类型")])]),_._v(" "),t("h4",{attrs:{id:"案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#案例","aria-hidden":"true"}},[_._v("#")]),_._v(" 案例")]),_._v(" "),t("h5",{attrs:{id:"课程表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#课程表","aria-hidden":"true"}},[_._v("#")]),_._v(" 课程表")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("列明")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("解释")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("课程ID(PK)")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td",[_._v("自增id应为整形  自增id无负数")])]),_._v(" "),t("tr",[t("td",[_._v("主标题(UK)")]),_._v(" "),t("td",[_._v("varchar(20)")]),_._v(" "),t("td",[_._v("不能超过20个汉字，增加唯一索引作为业务主键使用.")])]),_._v(" "),t("tr",[t("td",[_._v("副标题")]),_._v(" "),t("td",[_._v("varchar(50)")]),_._v(" "),t("td",[_._v("不能超过50个汉字")])]),_._v(" "),t("tr",[t("td",[_._v("课程方向ID")]),_._v(" "),t("td",[_._v("smallint unsigned")]),_._v(" "),t("td",[_._v("无符号的范围是0到65535")])]),_._v(" "),t("tr",[t("td",[_._v("课程分类ID")]),_._v(" "),t("td",[_._v("smallint unsigned")]),_._v(" "),t("td",[_._v("无符号的范围是0到65535")])]),_._v(" "),t("tr",[t("td",[_._v("课程难度ID")]),_._v(" "),t("td",[_._v("smallint unsigned")]),_._v(" "),t("td",[_._v("无符号的范围是0到65535")])]),_._v(" "),t("tr",[t("td",[_._v("上线时间")]),_._v(" "),t("td",[_._v("datetime")]),_._v(" "),t("td",[_._v("YYYY-MM-DD HH:MM:SS [.微秒值]")])]),_._v(" "),t("tr",[t("td",[_._v("学习人数")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td",[_._v("无符号的范围是0到4294967295")])]),_._v(" "),t("tr",[t("td",[_._v("课程时长")]),_._v(" "),t("td",[_._v("time")]),_._v(" "),t("td",[_._v("时间和用time")])]),_._v(" "),t("tr",[t("td",[_._v("课程简介")]),_._v(" "),t("td",[_._v("varchar(200)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("学习需知")]),_._v(" "),t("td",[_._v("varchar(200)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("课程收获")]),_._v(" "),t("td",[_._v("varchar(200)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("讲师ID")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("课程主图片")]),_._v(" "),t("td",[_._v("varchar(200)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("内容评分")]),_._v(" "),t("td",[_._v("decimal(3,1)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("简单易懂")]),_._v(" "),t("td",[_._v("decimal(3,1)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("逻辑清晰")]),_._v(" "),t("td",[_._v("decimal(3,1)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("综合评分")]),_._v(" "),t("td",[_._v("decimal(3,1)")]),_._v(" "),t("td")])])]),_._v(" "),t("h5",{attrs:{id:"课程章节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#课程章节","aria-hidden":"true"}},[_._v("#")]),_._v(" 课程章节")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("列名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("解释")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("章节ID(PK)")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("课程ID(UK)")]),_._v(" "),t("td",[_._v("int unsigend")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("章节名称（UK)")]),_._v(" "),t("td",[_._v("varchar(50)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("章节说明")]),_._v(" "),t("td",[_._v("varchar(200)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("章节编号")]),_._v(" "),t("td",[_._v("tinyint(2) unsigned ZEROFILL")]),_._v(" "),t("td",[_._v("因为一门课程的章节不会超过255 ，ZEROFILL 的作用就是在章节不足两位的时候在前面补0")])])])]),_._v(" "),t("h5",{attrs:{id:"课程小节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#课程小节","aria-hidden":"true"}},[_._v("#")]),_._v(" 课程小节")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("列名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("解释")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("小节ID(PK)")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("章节ID(UK)")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("课程ID(UK)")]),_._v(" "),t("td",[_._v("int unsigned")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("小节名称(UK)")]),_._v(" "),t("td",[_._v("varchar(50)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("小节URL")]),_._v(" "),t("td",[_._v("varchar(200)")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("视频格式")]),_._v(" "),t("td",[_._v("enum('avi','mp4','mpeg')")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("小节时长")]),_._v(" "),t("td",[_._v("time")]),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td",[_._v("章节编号")]),_._v(" "),t("td",[_._v("tinyint(2) unsigned ZEROFILL")]),_._v(" "),t("td")])])]),_._v(" "),t("h3",{attrs:{id:"数据库命名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库命名","aria-hidden":"true"}},[_._v("#")]),_._v(" 数据库命名")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("所有数据库对象名称必须使用小写字母可选下划线分割。")])]),_._v(" "),t("li",[t("p",[_._v("所有数据库对象名称定义禁止使用mySQL保留关键字")])]),_._v(" "),t("li",[t("p",[_._v("见名识以，不要超过32个字符")])]),_._v(" "),t("li",[t("p",[_._v("临时库表必须以tmp为前缀并以日期为后缀")])]),_._v(" "),t("li",[t("p",[_._v("用于备份的库,表必须以bak为前缀并以日期为后缀")])]),_._v(" "),t("li",[t("p",[_._v("所有存储相同数据的列名 和列类型必须一致")])])]),_._v(" "),t("h3",{attrs:{id:"mysql服务器参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql服务器参数","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQL服务器参数")]),_._v(" "),t("h4",{attrs:{id:"mysql获取配置信息路径"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql获取配置信息路径","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQL获取配置信息路径")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("命令行参数")]),_._v(" "),t("p",[_._v("mysqld_safe --datadir=/data/sql_data")])]),_._v(" "),t("li",[t("p",[_._v("配置文件")]),_._v(" "),t("p",[_._v("mysqld-help --verbose|grep -A 1'Default options' /etc/my.cnf/etc/mysql/my.cnf/home/mysql/my.cnf~/my.cnf")])])]),_._v(" "),t("h4",{attrs:{id:"mysql配置参数作用域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql配置参数作用域","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQl配置参数作用域")]),_._v(" "),t("ul",[t("li",[_._v("全局参数")])]),_._v(" "),t("p",[_._v("set global 参数名=参数值；")]),_._v(" "),t("p",[_._v("set @@global.参数名：=参数值；")]),_._v(" "),t("ul",[t("li",[_._v("会话参数")])]),_._v(" "),t("p",[_._v("set [session] 参数名=参数值；")]),_._v(" "),t("p",[_._v("set @@ session.参数名：=参数值；")]),_._v(" "),t("h4",{attrs:{id:"内存配置相关参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内存配置相关参数","aria-hidden":"true"}},[_._v("#")]),_._v(" 内存配置相关参数")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("确定可以使用的内存的上限")])]),_._v(" "),t("li",[t("p",[_._v("确定MySQl的每个连接使用的内存")]),_._v(" "),t("p",[t("code",[_._v("sort_buffer-size")]),_._v("  排序缓冲区尺寸 执行排序语句是分配的内存")]),_._v(" "),t("p",[t("code",[_._v("join_buffer-size")]),_._v(" 连接缓冲区大小")]),_._v(" "),t("p",[t("code",[_._v("read_buffer_size")]),_._v("  MYSIAM查询需要分配内存  必须是4的倍数")]),_._v(" "),t("p",[t("code",[_._v("read_rnd_buffer_size")]),_._v(" 索引缓冲区的大小")])])]),_._v(" "),t("h4",{attrs:{id:"如何为缓存池分配内存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何为缓存池分配内存","aria-hidden":"true"}},[_._v("#")]),_._v(" 如何为缓存池分配内存")]),_._v(" "),t("p",[t("code",[_._v("innodb_buffer_pool_size")])]),_._v(" "),t("p",[_._v("总内存-（每个线程所需要的内存*连接数）-系统保留内存")]),_._v(" "),t("p",[t("code",[_._v("key_buffer_size")]),_._v("(MYISAM)")]),_._v(" "),t("p",[_._v("select sum(index_length) from information_schema.tables where engine='myisam'")]),_._v(" "),t("p",[_._v("查询MYISAM 表占用索引大小")]),_._v(" "),t("h4",{attrs:{id:"innodb-i-o相关配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#innodb-i-o相关配置","aria-hidden":"true"}},[_._v("#")]),_._v(" Innodb I/O相关配置")]),_._v(" "),t("p",[t("code",[_._v("innodb_log_file_size")]),_._v(" 控制单个事务日志的大小\n"),t("code",[_._v("Innodb_log_files_in_group")]),_._v("  控制着事务文件日志的个数")]),_._v(" "),t("p",[_._v("事务日志总大小= innodb_log_files_in_group * Innodb_log_file_size")]),_._v(" "),t("p",[t("code",[_._v("innodb_log_buffer_size")]),_._v(" 控制事务缓存区大小")]),_._v(" "),t("ul",[t("li",[t("p",[t("code",[_._v("innodb_flush_log_at_trx_commit")])]),_._v(" "),t("p",[_._v("0:每秒进行一次log写入cache，并flush log到 磁盘")]),_._v(" "),t("p",[_._v("1:[默认]：在每次事务提交执行log写入cache，并flush log到磁盘")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("innodb_flush_method=O_DIRECT")]),_._v(" 通知操作系统不要缓存数据")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("innodb_file_per_table=1")]),_._v(" 控制Innodb 如何设置表空间")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("innodb_doublewrite=1")]),_._v(" 避免innodb使用双写缓存")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("delay_key_write")])]),_._v(" "),t("p",[_._v("OFF:每次写操作后刷新键 缓冲中毒的脏块到硬盘")]),_._v(" "),t("p",[_._v("ON:只对在键表时制定了delay_key_write 选项的表使用延迟刷新")]),_._v(" "),t("p",[_._v("ALL:对所有MYISAM 表都使用延迟写入")])])]),_._v(" "),t("h4",{attrs:{id:"安全相关配置参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安全相关配置参数","aria-hidden":"true"}},[_._v("#")]),_._v(" 安全相关配置参数")]),_._v(" "),t("p",[_._v("​\t"),t("code",[_._v("expire_logs_days")]),_._v(" 指定自动清理binlog的天数")]),_._v(" "),t("p",[t("code",[_._v("max_allowed_packet")]),_._v(" 控制mySQL可以接收包的大小")]),_._v(" "),t("p",[t("code",[_._v("skip_name_resolve")]),_._v(" 禁用DNS查找")]),_._v(" "),t("p",[t("code",[_._v("sysdate_is_now")]),_._v(" 确保sysdate() 返回确定性日期")]),_._v(" "),t("p",[t("code",[_._v("read_only")]),_._v(" 禁止非super权限的用户写权限")]),_._v(" "),t("p",[t("code",[_._v("skip_slave_start")]),_._v(" 禁用Slave自动恢复")]),_._v(" "),t("p",[_._v("=="),t("code",[_._v("sql_mode")]),_._v("设置MySQL所使用的SQl模式==")]),_._v(" "),t("ul",[t("li",[t("p",[t("code",[_._v("strict_trans_tables")]),_._v("如果给定的数据不能插入到事务性存储引擎中,则会中断当前操作，对非事务型存储引擎没有任何影响")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("no_engine_subtitution")]),_._v(" 如何在create table 语句中所指定的存储引擎不可用的情况下，不会使用默认的存储引擎创建成功")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("no_zero_date")]),_._v(" 在严格的sql模式下 不能把 0年0月0日写入日期字段上")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("no_zero_in_date")]),_._v("在严格的sql模式下 不能接受部分日期为0的日期")])]),_._v(" "),t("li",[t("p",[t("code",[_._v("only_full_group_by")]),_._v("  把所有没有聚合函数的列都列出来 ,否则sql语句不能执行")])])]),_._v(" "),t("h4",{attrs:{id:"其他常用配置参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他常用配置参数","aria-hidden":"true"}},[_._v("#")]),_._v(" 其他常用配置参数")]),_._v(" "),t("p",[t("code",[_._v("sync_binlog")]),_._v(" 控制MySQL 如何向磁盘刷新 binlog")]),_._v(" "),t("p",[t("code",[_._v("tmp_table_size")]),_._v(" 和"),t("code",[_._v("max_heap_table_size")]),_._v(" 控制内存临时表大小")]),_._v(" "),t("p",[t("code",[_._v("max_connections")]),_._v(" 控制允许的最大连接数")]),_._v(" "),t("h3",{attrs:{id:"mysql基准测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql基准测试","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQl基准测试")]),_._v(" "),t("blockquote",[t("p",[_._v("基准测试时一种测量和评估软件性能指标的活动用于建立某个时刻的性能基准,以便当系统发生软硬件变化时重新进行基准测试以评估变化对性能的影响")])]),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191014195315.png"}}),_._v(" "),t("h4",{attrs:{id:"mysql基准测试的常见指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql基准测试的常见指标","aria-hidden":"true"}},[_._v("#")]),_._v(" MySQl基准测试的常见指标")]),_._v(" "),t("ul",[t("li",[_._v("单位时间内所处理的事务数（TPS）")]),_._v(" "),t("li",[_._v("单位时间内所处理的查询数（QPS）")]),_._v(" "),t("li",[_._v("响应时间")]),_._v(" "),t("li",[_._v("并发量：同时处理的查询请求的数量")])]),_._v(" "),t("h4",{attrs:{id:"计划和设计基准测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#计划和设计基准测试","aria-hidden":"true"}},[_._v("#")]),_._v(" 计划和设计基准测试")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("准备基准测试及数据收集脚本")]),_._v(" "),t("p",[_._v("CPU使用率,IO,网络流量、状态与计数器信息\t"),t("code",[_._v("GET_\tTest_info.sh")])])])]),_._v(" "),t("h4",{attrs:{id:"常用基准测试工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用基准测试工具","aria-hidden":"true"}},[_._v("#")]),_._v(" 常用基准测试工具")]),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191014200622.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191014200931.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"75%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191014200758.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"75%"},attrs:{src:"https://raw.githubusercontent.com/pleiades-embers/images/master/20191014201150.png"}}),_._v(" "),t("h3",{attrs:{id:"b-tree-索引的特点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-tree-索引的特点","aria-hidden":"true"}},[_._v("#")]),_._v(" B-tree 索引的特点")]),_._v(" "),t("ul",[t("li",[_._v("B-tree 索引能够加快数据的查询速度")]),_._v(" "),t("li",[_._v("B-tree索引更适合进行范围查找")])]),_._v(" "),t("h4",{attrs:{id:"在什么情况下可以用到b树索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在什么情况下可以用到b树索引","aria-hidden":"true"}},[_._v("#")]),_._v(" 在什么情况下可以用到B树索引")]),_._v(" "),t("ul",[t("li",[_._v("全值匹配查询 "),t("code",[_._v("order_sn='9876432119900'")])]),_._v(" "),t("li",[_._v("匹配最左前缀的查询")]),_._v(" "),t("li",[_._v("匹配列前缀查询"),t("code",[_._v("order_sn")]),_._v(" like "),t("code",[_._v("9876%")])]),_._v(" "),t("li",[_._v("匹配范围值的查询\n"),t("ul",[t("li",[_._v("order_sn>"),t("code",[_._v("9876432119900")])]),_._v(" "),t("li",[_._v("and order_sn <"),t("code",[_._v("9876432119999")])])])]),_._v(" "),t("li",[_._v("精确匹配左前列并范围匹配另外一列")]),_._v(" "),t("li",[_._v("只防卫索引的查询")])]),_._v(" "),t("h4",{attrs:{id:"btree-索引的使用限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#btree-索引的使用限制","aria-hidden":"true"}},[_._v("#")]),_._v(" Btree 索引的使用限制")]),_._v(" "),t("ul",[t("li",[_._v("如果不是按照索引最左列开始查找，则无法使用索引")]),_._v(" "),t("li",[_._v("使用索引时不能跳过索引中的列")]),_._v(" "),t("li",[_._v("Not in 和 <> 操作无法使用索引")]),_._v(" "),t("li",[_._v("如果查询中有某个列的范围查询，则其右边所有列都无法使用索引")])]),_._v(" "),t("h3",{attrs:{id:"hash-索引的特点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hash-索引的特点","aria-hidden":"true"}},[_._v("#")]),_._v(" Hash 索引的特点")]),_._v(" "),t("ul",[t("li",[_._v("Hash索引是基于Hash 表实现的，只有查询条件精确匹配 Hash 索引中的所有列示，才能够使用到hash索引")]),_._v(" "),t("li",[_._v("对于Hash 索引中的所有列，存储引擎都会为每一行计算一个Hash码，Hash缩影中存储的就是Hash码")])]),_._v(" "),t("h4",{attrs:{id:"hash索引的限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hash索引的限制","aria-hidden":"true"}},[_._v("#")]),_._v(" Hash索引的限制")]),_._v(" "),t("ul",[t("li",[_._v("Hash索引必须进行二次查找")]),_._v(" "),t("li",[_._v("Hash缩影无法用于排序")]),_._v(" "),t("li",[_._v("Hash缩影不支持部分索引查找也不支持范围查找")]),_._v(" "),t("li",[_._v("Hash索引中Hash码计算可能存在Hash冲突")]),_._v(" "),t("li",[_._v("索引大大减少了存储引擎需要扫描的数据量")]),_._v(" "),t("li",[_._v("索引可以帮助我们进行排序以避免使用零时表")]),_._v(" "),t("li",[_._v("索引可以把随机I/O变为顺序I/O")])])])},[],!1,null,null,null);v.default=a.exports}}]);